<style>
  /* General form styling */
  #resetPasswordDiv {
    width: 300px;
    margin: 0 auto;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f5f5f5;
  }

  /* Form heading */
  h1 {
    text-align: center;
    margin-bottom: 20px;
  }

  /* Label and input fields */
  label {
    display: block;
    margin-bottom: 5px;
  }

  input[type="password"] {
    width: 100%;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    margin-bottom: 15px;
  }

  /* Button */
  #resetPasswordBtn {
    background-color: #4caf50;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
  }
</style>

<script>
  const resetHandler = (event) => {
    event.preventDefault();
    // Get the values of the inputs
    const resetToken = document.getElementById("resetToken").value;
    const newPassword = document.getElementById("newPassword").value;

    fetch("https://ipol-server.onrender.com/api/users/reset-password", {
      method: "PUT",
      body: JSON.stringify({ resetToken, newPassword }),
    })
      .then((response) => {
        if (response.status === 200) {
          // Display success message
          alert("Password reset successful! Closing window in 5 seconds...");

          // Close the window after 5 seconds
          setTimeout(() => {
            window.close();
          }, 5000);
        } else {
          throw new Error("Password reset not successful!");
        }
        return response.json();
      })
      .catch((error) => {
        // Handle error (e.g., display user-friendly error message)
      });
  };
</script>

<div>
  <h1>Reset Password</h1>

  <div id="resetPasswordDiv">
    <input
      type="hidden"
      id="resetToken"
      name="resetToken"
      value="<%= resetToken %>"
    />
    <div>
      <label for="newPassword">New Password:</label>
      <input type="password" id="newPassword" name="newPassword" required />
    </div>
    <button id="resetPasswordBtn" onclick="resetHandler()">
      Reset Password
    </button>
  </div>
</div>
